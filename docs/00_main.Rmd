---
output:
  officedown::rdocx_document:
    reference_docx: resources/ECM_1694746_v2_ReportingTemplate_2023.docx
    fig_caption: yes
    highlight: tango
    toc: yes
    toc_depth: 2
    number_sections: no
    tables:
      style: Table Grid
      layout: autofit
      width: 1.0
      caption:
        style: Table Caption
        pre: 'Tables '
        sep: ': '
        tnd: 0
    plot:
      caption:
        style: Image Caption
        tnd: 0
    reference_num: true
    page_margins:
      bottom: 1
      top: 1
      left: 1
      right: 1
      header: 0.49
      footer: 0.49
      gutter: 0
    page_size:
      width: 8.3
      height: 11.7
      orient: 'portrait'
  bookdown::word_document2:
    reference_docx: resources/ECM_1694746_v2_ReportingTemplate_2019.docx
    fig_caption: yes
    fig_height: 4
    fig_width: 4
    highlight: tango
    toc: yes
    toc_depth: 2
    number_sections: no
    tables:
      style: Style1-Emphasize1
      layout: autofit
    page_margins:
      bottom: 1
      top: 1
      left: 1
      right: 1
      header: 0.49
      footer: 0.49
      gutter: 0
    page_size:
      width: 8.3
      height: 11.7
      orient: 'portrait'
  word_document:
    fig_caption: yes
    fig_height: 4
    fig_width: 4
    highlight: tango
    toc: yes
    toc_depth: 2
  page_size:
    width: 8.3
    height: 11.7
    orient: 'portrait'

bibliography: resources/references.bib
output_dir: "docs"
documentclass: article
fontsize: 12pt
mainfont: Arial
mathfont: LiberationMono
monofont: DejaVu Sans Mono
classoption: a4paper
---

<w:updateFields w:val="true"/>

```{r setup, include=FALSE, warnings=FALSE, message=FALSE}
assignInNamespace('.sep.label',  "^\\ *(#|--)+\\s*(@knitr|----+)(.*?)-*\\s*$", ns='knitr')

tidyverse_style_with_comments_removed <- function() {
  remove_comments <- function(pd) {
    is_comment <- pd$token == "COMMENT"
    pd <- pd[!is_comment,]
    pd
  }
  tidyverse_with_comments_removed <- styler::tidyverse_style()
  tidyverse_with_comments_removed$token$remove_comments <- remove_comments
  tidyverse_with_comments_removed
}

knitr::opts_chunk$set(message=FALSE, warning=FALSE,cache.lazy = FALSE, tidy='styler', echo = FALSE,
                      tidy.opts=list(transformers = tidyverse_style_with_comments_removed()))
## knitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE)

# save the built-in output hook
hook_output <- knitr::knit_hooks$get("output")

# set a new output hook to truncate text output
knitr::knit_hooks$set(output = function(x, options) {
  if (!is.null(n <- options$out.lines)) {
    x <- xfun::split_lines(x)
    if (length(x) > n) {
      # truncate the output
      x <- c(head(x, n), "....\n")
    }
    x <- paste(x, collapse = "\n")
  }
  hook_output(x, options)
})
library(officedown)
library(tidyverse)
library(officer)
library(rmarkdown)
library(knitr)
library(flextable)
library(skimr)

options(tinytex.engine = 'xelatex')
knitr::read_chunk('../scripts/functions.R')
knitr::read_chunk('../scripts/00_main.R')
knitr::read_chunk('../scripts/10_get_data.R')
knitr::read_chunk('../scripts/20_process_data.R')
knitr::read_chunk('../scripts/30_EDA.R')
knitr::read_chunk('../scripts/50_summaries_trees.R')

source('../scripts/functions.R')
PROCESS_TABLES <- FALSE
INCLUDE_FIGURES <- FALSE
INCLUDE_DIAGNOSTICS <- FALSE
PERFORM_ASSOC <- FALSE
PERFORM_TREES <- TRUE

```

**List of tables**

<!---BLOCK_TOC{seq_id: "tab"}--->

**List of figures**

<!---BLOCK_TOC{seq_id: "fig"}--->
 


# Background
The pressure monitoring sub-program within the Integrated Marine
Monitoring and Research Program (IMMRP) collates data on various
pressures of perceived relevance to Darwin Harbour. An objective of
the IMMRP pressure monitoring sub-program is to, where possible,
explore relationships between pressures (and drivers) and stressor and
response variables to understand key influences on marine condition,
and to incorporate ‘multiple lines of evidence’ into condition
assessments.


# Project Scope
This project comprises an exploratory statistical investigation of
pressure - stressor relationships utilising the water quality data
underpinning the Darwin Harbour (Water Quality) Report Card as a first
step toward attribution. The driving question behind the study is what
if any of the myriad of pressures show relationships.

# Methods

## Data regions

Darwin Harbour comprises nine *zones* (Figure
\@ref(fig:Darwin-harbour)) that are collectively surrounded by 22
sub-catchments (Figure \@ref(fig:Darwin-harbour-subcatchments)).  The
stressors (select water quality measures) are were collected within
the Darwin Harbour zones.  By contrast, the pressures (large range of
potential drivers of the stressors) are collected at either the scale
of the whole harbour or else pertain to the surrounding
sub-catchments.  Sub-catchments were aligned to the harbour zones (for
the purpose of exploring associations) in
accordance with Table \@ref(tab:lookup-spatial).

```{r Darwin-harbour, results='markdown', eval=TRUE, fig.show='hold',fig.align='center', fig.width = 6, fig.asp = 8/8, fig.cap = "Map of Darwin Harbour illustrating the zones."}
include_graphics("../output/figures/map_spatial.png", dpi = 300)
```

```{r Darwin-harbour-subcatchments, results='markdown', eval=TRUE, fig.width = 6, fig.asp = 7/8, out.width = 7, out.height = 8, fig.cap = "Map of Darwin Harbour illustrating the sub-catchments."}
include_graphics("../output/figures/map_spatial_subcatchments.png", dpi = 300)
```

```{r spatial lookup, results='markdown', eval=TRUE}
sdat <- readRDS(file = paste0(DATA_PATH, "processed/spatial_lookup.RData"))
subdat <- readRDS(file = paste0(DATA_PATH, "processed/spatial_subcatchments_lookup.RData"))
sdat <- subdat %>% dplyr::select(Catchment, ZoneName) %>%
    left_join(sdat %>% dplyr::select(ZoneName, RegionName, Area)) %>%
    setNames(c("Sub-catchment", "Zone", "Region", "Area"))
sdat %>%
  flextable::flextable() %>%
  flextable::fontsize(size = 9, part = "all") %>%
  ## flextable::line_spacing(space = 0.2, part = "body") %>%
  ## flextable::line_spacing(space = 0, part = "header") %>%
  flextable::set_table_properties(layout = "autofit") %>%
  ## flextable::autofit() %>%
  ##flextable::align(j = c(3,4), align = "right") %>%
    flextable::padding(padding.top = 0.1, padding.bottom = 0.2, part = "body") %>%
    flextable::padding(padding.bottom = 5, part = "header") %>%
    flextable::padding(i = nrow(sdat), padding.bottom = 5, part = "body") %>%
    set_caption(
        as_paragraph(
            as_chunk("Spatial associations between Darwin Harbour sub-catchments and water zones, regions and areas.")
        ),
        word_stylename = "Table Caption",
        autonum = run_autonum(seq_id = "tab",
                              bkm = "lookup-spatial")
    )
```

## Data sets

All of the data were provided via email from the Northern Territory
Government Department of Environment , Parks and Water Security
(DEPWS) (Wed 30/09/2022 13:24 , Tue 10/01/2023 08:39 and Tue
10/01/2023 08:58) and (Tue 26/09/2022 12:32)

Summaries of the structure and contents of each of the data sets are
provided in Appendix A.  An overal summary of the *stressors* and
*pressures* is provided in Table \@ref(tab:lookup-measures) and the
individual stressor/pressures are described in the following sections.

Prior to analyses , each of the data sets were subject to substantial
processing in order to standardise any spatial information , ensure
consistent names and remove any duplicate or extraneous fields.  The
exact specifics of the data processing steps performed on each data
set can be gleaned from the code repository hosted at
https://github.com/open-AIMS/darwin_pressures.


```{r measures lookup, results='markdown', eval=TRUE, cache = TRUE}
dat_units <- readRDS(file = paste0(DATA_PATH, "processed/units_lookup.RData")) %>%
    ##mutate(Units = str_replace_all(Units,"\\$","\\\\$"),
 #       TableLabel = str_replace_all(TableLabel,"\\$","\\\\$"),
#		FigureLabel = str_replace_all(FigureLabel,"\\$","\\\\$")) %>% 
    dplyr::select(-Trans, -FigureLabel)
sdat <- readRDS(file = paste0(DATA_PATH, "processed/var_lookup.RData")) %>%
  mutate(Var = str_replace_all(Var,"\\$","\\\\$")) %>%
    dplyr::select(-ID, -SITE_ID, -Scale) %>%
    mutate(Type = ifelse(Type == "Response", "Stressor", Type)) %>%
    left_join(dat_units %>% dplyr::select(Measure, Units)) %>%
    dplyr::select(Type, Dataset, Var, Units) 
## Start again with the table from scratch...

sdat <- tribble(
    ~Type,      ~Class,                      ~Indicator,                                                         ~Units,         
   "Stressor",  "Water quality (2012-2022)", "Chlorophyll-a",                                                    "μg/L",         
   "Stressor",  "Water quality (2012-2022)", "Turbidity",                                                        "NTU",          
   "Stressor",  "Water quality (2012-2022)", "Dissolved oxygen",                                                 "%",            
   "Stressor",  "Water quality (2012-2022)", "Ammonia",                                                          "μg/L",         
   "Stressor",  "Water quality (2012-2022)", "Phosphate Total Filterable",                                       "μg/L",         
   "Stressor",  "Water quality (2012-2022)", "NOx",                                                              "μg/L",         
   ## "Stressor",  "Water quality (2015-2015)", "Chlorophyll-a",                                                    "μg/L",         
   ## "Stressor",  "Water quality (2012-2015)", "Turbidity",                                                        "NTU",          
   ## "Stressor",  "Water quality (2012-2015)", "Dissolved oxygen",                                                 "%",            
   ## "Stressor",  "Water quality (2012-2015)", "Ammonia",                                                          "μg/L",         
   ## "Stressor",  "Water quality (2012-2015)", "Phosphate Total Filterable",                                       "μg/L",         
   "Pressure",  "Point source load",         "Total N",                                                          "t",            
   "Pressure",  "Point source load",         "Total P",                                                          "t",            
   "Pressure",  "Point source load",         "Discharge volume",                                                 "kL",           
   "Pressure",  "Point source load",         "Total suspended solids",                                           "t",            
   "Pressure",  "Point source load",         "Volatile suspended solids",                                        "t",            
   "Driver",    "Human population",          "Estimated resident population (ERP)",                              "",             
   "Driver",    "Human population",          "Estimated resident population growth",                             "",             
   "Driver",    "Economic activity",         "Gross regional product (GRP)",                                     "$M",           
   "Driver",    "Economic activity",         "Gross regional product change",                                    "%",            
   "Driver",    "Human population",          "Catchment estimated resident population",                          "",             
   "Driver",    "Human population",          "Population density",                                               "pop/km²",      
   "Pressure",  "Marine",                    "Mean sea level",                                                   "m",            
   "Accessory", "Climate",                   "Rainfall anomaly",                                                 "mm",           
   "Accessory", "Climate",                   "Annual mean air temperature",                                      "℃",            
   "Accessory", "Climate",                   "Annual maximum air temperature anomaly",                           "℃",            
   "Accessory", "Climate",                   "Mean air temperature anomaly",                                     "℃",            
   "Driver",    "Climate",                   "Average annual Southern Oscillation Index",                        "",             
   "Accessory", "Climate",                   "Sea surface temperature anomaly",                                  "℃",            
   "Pressure",  "Catchment/economic",        "Total building activity",                                          "$B",           
   "Pressure",  "Catchment/economic",        "Engineering building activity",                                    "$B",           
   "Pressure",  "Catchment/economic",        "Non-residential building activity",                                "$B",           
   "Pressure",  "Catchment/economic",        "Residential building activity",                                    "$B",           
   "Pressure",  "Marine",                    "Number of trade ships",                                            "",             
   "Pressure",  "Marine",                    "Number of container ships (includes general cargo & Ro-Ro ships)", "",             
   "Pressure",  "Marine",                    "Number of liquid bulk ships",                                      "",             
   "Pressure",  "Marine",                    "Number of car carrier ships",                                      "",             
   "Pressure",  "Marine",                    "Number of rig tender ships",                                       "",             
   "Pressure",  "Marine",                    "Number of livestock ships",                                        "",             
   "Pressure",  "Marine",                    "Number of cruise ships",                                           "",             
   "Pressure",  "Marine",                    "Number of dry bulk ships",                                         "",             
   "Pressure",  "Catchment",                 "Five year moving average fire frequency",                          "times burned", 
   "Pressure",  "Catchment",                 "Five year standard deviation fire frequency",                      "times burned", 
   "Pressure",  "Catchment",                 "Total fire area",                                                  "km²",          
   "Pressure",  "Catchment",                 "Percentage fire area",                                             "%",            
   
   
    )

sdat %>% 
  flextable::flextable() %>%
  ## flextable::fontsize(size = 9, part = "all") %>%
  ## flextable::line_spacing(space = 0.2, part = "body") %>%
  ## flextable::line_spacing(space = 0, part = "header") %>%
  ## flextable::set_table_properties(layout = "autofit") %>%
  ## flextable::autofit() %>%
  ##   fit_to_width(6.5) %>%
  ##flextable::align(j = c(3,4), align = "right") %>%
    flextable::padding(padding.top = 0.1, padding.bottom = 0.2, part = "body") %>%
    flextable::padding(padding.bottom = 5, part = "header") %>%
    flextable::padding(i = nrow(sdat), padding.bottom = 5, part = "body") %>%
    flextable::footnote(i = 1:6, j = 3,
                        ref_symbols = c("a"),
                        inline = TRUE,
                        value = as_paragraph("Routine samples")
                        ) %>%
    flextable::footnote(i = 1:6, j = 3,
                        ref_symbols = c("b"),
                        inline = TRUE,
                        value = as_paragraph("Discrete samples")
                        ) %>%
    flextable::footnote(i = 1:5, j = 3,
                        ref_symbols = c("c"),
                        inline = TRUE,
                        value = as_paragraph("Continuous flow management samples (2016-2022)")
                        ) %>%
    width(1, 1) %>%
    width(2, 2) %>%
    width(3, 2) %>%
    width(4, 1.27) %>%
    flextable::fontsize(size = 9, part = "all") %>%
  set_caption(
    as_paragraph(
      as_chunk("Summary of stressors and pressures/drivers along with their respective units of measurement and the datasets from which they are sourced.")
    ),
    word_stylename = "Table Caption",
    autonum = run_autonum(seq_id = "tab",
                          bkm = "lookup-measures")
  )
```

\newpage
### Stressor data

The stressor data comprised numerous water quality measures, each of
which represents a different potential indicator of water ecosystem
health or stress (Table \@ref(tab:lookup-measures)):

- Chlorophyll-a
- Turbidity
- Dissolved oxygen
- Ammonia
- Phosphate
- Nitrate and Nitrite (NOx)

These stressors are collected via multiple techniques and schedules
and for different purposes.

- *routine samples* represented samples collected by hand at fixed
  sites as part of a water quality monitoring program.  The sites were
  selected as representatives of the water zones (see Table
  \@ref(tab:lookup-spatial) and Figure \@ref(fig:wq-routine-spatial)) and
  thus to provide strategic insights into the long-term
  spatio-temporal patterns of water quality and to feed into a water
  health reporting card.
- *discrete samples* comprise the routine samples along with
  additional samples collected for a range of purposes (Figure
  \@ref(fig:map-wq-discrete)).
- *continuous flow management (CFM) samples* samples are collected via
  a system that draws water samples at regular intervals (whilst the
  vessel is in motion), analyses them and couples the with a GPS for
  geocoding (Figure \@ref(fig:wq-2016-spatial-all)). Whilst very
  numerous, the CFM samples do not provide independent water quality
  estimates and are also highly biased towards the vessel paths - and
  thus not necessarily reflective of the water zones.  Furthermore, as
  they are highly varied in location and frequency between years, the
  biases in estimates will fluctuate between years and locations and
  thus, they are extremely challenging to use for inferring any
  spatio-temporal patterns.

Since the purpose of this study is to relate temporal trends in the
pressures and stressors, the analyses focused on the routine and
discrete samples only.

Visual summaries of the spatio-temporal data collection design of
samples from each of the above regimes along with itemised steps of
any data processing are presented in Appendix D.

```{r wq-routine-spatial}
#| results: 'markdown'
#| eval: TRUE
#| fig.show: 'hold'
#| fig.align: 'center'
#| fig.width: 6.5
#| fig.height: 8.357
#| fig.cap: "Spatio-temporal distribution of routine sampling locations."

include_graphics("../output/figures/map_wq__routine_sites_large.png", dpi = 300)
```

```{r map-wq-discrete}
#| results: 'markdown'
#| eval: TRUE
#| fig.show: 'hold'
#| fig.align: 'center'
#| fig.width: 6.5
#| fig.height: 6.5
#| fig.cap: "Spatio-temporal distribution of discrete sampling locations between 2012 and 2022"

include_graphics("../output/figures/map_wq_large.png", dpi = 300)
```

```{r wq-2016-spatial-all}
#| results: 'markdown'
#| eval: TRUE
#| fig.show: 'hold'
#| fig.align: 'center'
#| fig.width: 6.5
#| fig.height: 7.42
#| fig.cap: "Spatio-temporal distribution of all sampling locations between 2016 and 2022."

include_graphics("../output/figures/map_wq__2016_2022_all_large.png", dpi = 300)
```

### Pressure data

The pressure data represented a range of physicochemical, climatic,
economic and anthropogenic measures that have the potential to drive
fluctuations (place pressure on) the measures of water stress (Table
\@ref(tab:lookup-measures):

- Sub-catchment level total nitrogen, phosphorus, discharge volume,
  suspended and volatile solids
- Harbour level estimated resident population (ERP), ERP growth, gross
  regional product (GRP), annual change in GRP
- Sub-catchment level ERP and population density (POP)
- Harbour level average annual sea level (financial year)
- Harbour level precipitation anomaly, mean air temperature, maximum
  air temperature anomaly, average southern oscillation index (SOI)
  and sea surface temperature anomaly (SST)
- Sub-catchment level building expenditure engineering,
  non-residential, residential and total
- Sub-catchment level shipping counts for trade, cargo/container,
  liquid bulk, car carriers, rig tenders, livestock, cruise and dry
  bulk
- Harbour level fire frequency average and variability
- Sub-catchment level fire frequency area and percentage


Visual summaries of the available pressures data along with itemised
steps of any data processing are presented in Appendix E.

<!--
## Data regions

The stressor data were collected as part of a sampling design employed
to monitor the health of the Darwin Harbour.  In recognition that the
levels of each stressor and the temporal trends thereof might
potentially vary substantially across the harbour, the monitoring
program stratified the samples within nine *zones*.


For this purpose, Darwin
Harbour was partitioned up into nine *zones* (see Figure
\@ref(fig:Darwin-harbour)).  Importantly, the levels of each of the
stressors and the temporal trends thereof vary substantially between
the different zones.  Hence, the relationships between pressures and
stressors will be explored both searately within each of the zones as
well as collectively across the whole harbour.

-->


<!-- The following sub-sections each
correspond to particular sets of provided data.  In each case, the
data have been summarised to provide an overview of the structure and
contents of the provided data.  --> <!--In each of these sub-sections,
I provide the code for importing the data into R along with a glimpse
of the raw data.-->

### Combine all data

In combining together the stressors along with the pressures, it was
important to recognise that they were collected on different spatial
and temporal scales.  Hence, all the sources were combined together
via their common spatial and temporal scales.

For temporal scales, it was simple enough to base this on the
financial year since most of the data were already expressed this way,
or else the conversions are simple enough.  However, the spatial
scales were more difficult, particularly considering that the water
quality data (stressors) are collected in water and the pressures are
predominantly collected terrestrially. The only real way to address
this was to be able to associate each of the _sub-catchments_ to a
single harbour _Zone_.

Consequently, all analyses were conducted on the zone/year scale (in
addition to a whole harbour/year scale).  There were many instances
(both stressors and pressures) in which there were multiple
observations collected per zone/year. As a result, when the multiple
sources were combined together, the number of data set rows increased
dramatically.  For example, often a given water quality observation
appeared multiple times, once for each pressure observation at that
zone/year scale.

This duplication was not necessarily an issue, however, we needed to
be mindful of it so as to prevent it from artificially over or under
weighting some effects and some observations.  To help with this,
unique record identifiers were added to the water quality components.

The alternative was to aggregate all data to the zone/year level such
that there were no more than one observation (per stressor and
predictor) per zone/year. Although this would have simplified things,
it had the potential to loose vast quantities of information.

# Analyses

## Simple exploratory trends between stressors and individual pressures

Temporal trends in both stressors and pressures were explored via
Generalized Additive Models (GAMs, @Wood-2017) separately for each
zone.  These are presented graphically in Appendix B and C
respectively.

## Associations between stressors and pressures

This project aims to explore relationships between a set of water
quality stressors that are important targets of a Darwin Harbour water
quality monitoring program and a collection of potential drivers
(pressures).  In general, statistical explorations into potential
associations between sets of variables can be a very difficult
exercise.  The difficulties are often further exacerbated when the set
of variables to be correlated originate from multiple different
sources and are environmental data. <!-- particularly if those sources
collect data at very different spatial and temporal scales.-->

Firstly, most environmental stressors and pressures data are
irregularly and sparsely collected as well as highly noisy.  That is,
the observation space usually represents a tiny fraction of the full
potential sampling domain.  Hence, the granularity of the data can
limit the sensitivity of any analyses.

Secondly, data assembled from disparate sources are typically
collected on differing sparse spatial and temporal scales (as the
collections are governed for different purposes).  Consequently, there
are no guarantees that scales of the data will be relevant to the
scales at which any underlying biochemical interactions actually take
place.  Moreover, since the observations from different sources rarely
align in space and time and the underlying conditions can fluctuate
rapidly, only very large-scale (in time or space) drivers are going to
manifest as observable associations.

Finally, when performing large numbers of statistical analyses to
explore a high-dimensional space, it is important to acknowledge that
the likelihood of Type I errors (false statistical conclusions)
increase dramatically.  Implicit in any single classical statistical
analysis is notion that we base conclusions about entire populations
on the single samples we have available.  If the patterns in these
samples are highly structured (non-random), we conclude that there is
evidence of the association.  However, it is possible that just by
chance we happened to collect unusual samples that portray a pattern
that is just an artefact and does not actually occur more broadly.
The more of the analyses we perform, the more likely it is that at
least one of these analyses purely reflects an artefact rather than a
genuine pattern.  Hence, the presence of correlations or associations
in samples does not necessarily mean that they definitely exist in the
populations.

Even if we accept that a given statistical correlation or association
is genuine, it does not necessarily signify that the relationship is
causal.  Two variables could co-vary as a result of both being driven
by another unobserved (latent) influence.  Furthermore, in models that
contain multiple covariates (predictors), the presence or absence of
associations involving one predictor can be the result of confounding
or masking due to other observed or unobserved influences.

There are many different approaches that can be employed in order to
explore the associations between sets of variables.  One approach is
to fit univariate generalized linear (mixed) models (GLMM's,
@Bolker-2008-127) that relate a single _response_ (in this case
stressor) to a small number of uncorrelated _predictors_ (pressures)
within a hierarchical (spatial) structure.  GLMM's are well
established statistical routines that evaluate the evidence for
low-dimensional trends.

Increased complexity can be explored via generalized additive (mixed)
models (GAMMs, @Wood-2017).  Rather than fit simple linear (or
polynomial) trends through data, GAMM's fit splines and thus are not
constrained to evaluating evidence of very simple trends in the data.

Both GLMMs and GAMMs are designed for relatively low-dimensional
explorations of the data space.  Neither are well suited to exploring
associations between a response and predictors when there are
correlations among the predictors.  High correlations among pressures
is a predictable feature of environmental data.  For example, climatic
variables such as temperature, precipitation and wind are often highly
correlated.

Machine learning technologies are often better suited to higher
dimensional problems.  Unfortunately, many of these are focused purely
on prediction and are of little use in attribution - that is, these
models are able to predict very well, however, they are typically
unable to understand what predictors are the most important in driving
the predicted patterns.  Boosted regression model (GBM, @Elith-2011)
trees are an amalgamation of statistical and machine learning routines.
They are able to leverage the superior prediction capabilities of
machine learning, with the attribution capabilities of statistical
models.

Although it is possible to fit a boosted regression tree with
correlated predictors, it is important to understand that when doing
so, the importance of the predictor most strongly correlated to the
response will tend to be elevated at the expense of any other
predictors correlated to this predictor.  The model is essentially
saying that the other correlated predictors do not reveal much
additional novel associations with the response that the other
predictor has not already offered.

Each of the above techniques (GLMM/GAMM and GBM) allow us to explore
the associations from different angles.  Consequently, rather than
considering them as competing candidate approaches and attempt to
intuit which approach is more likely to be best in any given
situation, I have elected to use both techniques in a complimentary
manner.  Each approach will provide a different (yet not entirely
independent) line of evidence of the strength and polarity of
associations between the stressors and pressures.

It should be noted that the GLMM/GAMM models feature only a single
stressor at a time and therefore, stressors that are correlated to one
another (and thus have similar relationships to the pressures) will
show similar statistical outcomes.  Contrastingly, each GBM contains
the full set of predictors and highly correlated predictors will tend
to complete with one another and the most highly correlated to the
response will typically win out.  Hence, in GBMs, the statistical
outcomes associated with individual pressures that are highly
correlated to one another may be profoundly different.  It is for this
reason, that the two approaches can be seen as complimentary.

### Generalised linear mixed effects models

For each of the five stressors (ammonia, chlorophyll-a, dissolved
oxygen, filterable reactive phosphorus and turbidity), a series of
generalised linear mixed models and generalised additive mixed models
relating the stressor to one of the 33 single focal pressures were fit
against a Gamma (log link) distribution.

Regular model fitting protocols usually involve a cycle in which a
model is fit, a range of associated model diagnostics are reviewed and
if necessary, repeat the cycle with modifications of the model until
the practitioner is satisfied that there is no evidence of a lack of
model fit.  However, for the current project, there are too many
modelling combinations to permit us to complete this regular cycle.
Consequently, instead, each model was fit using a set of possible
model candidates (see below) and then the model that best satisfied
the model diagnostics was chosen.  Model diagnostic included tests for
uniformity, (over) dispersion, outliers and residual quantile patterns
all based on simulated residuals (DHARMa).

If more than one model satisfied the diagnostic conditions, then the
candidate model was selected on the basis of the lowest AIC (Akaike
Information Criterion).  All models were fit via Restricted/Residual
Maximum Likelihood (REML) to minimise bias due to the random effects.

- Model 1: mixed effect model with polynomial effects and first order auto-regressive structure 
  $$
  \begin{align}
  y_{ij} &\sim{} \Gamma(\mu_{ij}, \phi)\\
  log(\mu_{ij}) &= \beta_0 + \beta_1 x_{ij} + \beta_2 x_{ij}^2 + \beta_3 x_{ij}^3 + \gamma[Site_j] + \theta(y_{ij-1} - \mu_{ij-1})
  \end{align}
  $$
  
  where:
  
  - $y_{ij}$ is the $i^{th}$ observation in the $j^{th}$ Site
  - $\mu_{ij}$ represents the expected mean of the $i^{th}$
    observation in the $j^{th}$ Site
  - $\phi$ represents the dispersion parameter of the gamma
    distribution, controlling the shape of the distribution
  - $\beta_0$, $\beta_1$, $\beta_2$ and $\beta_3$ are the polynomial
    regression terms
  - $\gamma[Site_j\$ is the random intercept for the $j^th$ Site
  - $\theta(y_{ij-1} - \mu_{ij-1})$ is the stationary first order
    autoregressive structure, indicating the effect of the lagged
    dependent variable on the current mean within the $j^{th}$ Site.
    It has a covariance of $\sigma^2 exp(-\theta|s-t|)$ where $s$ and
    $t$ represent $y_i$ and $y_i-1$ respectively.

- Model 2: mixed effect model with polynomial effects 
  $$
  \begin{align}
  y_{ij} &\sim{} \Gamma(\mu_{ij}, \phi)\\
  log(\mu_{ij}) &= \beta_0 + \beta_1 x_{ij} + \beta_2 x_{ij}^2 + \beta_3 x_{ij}^3 + \gamma[Site_j] 
  \end{align}
  $$
  
  where:
  
  - $y_{ij}$ is the $i^{th}$ observation in the $j^{th}$ Site
  - $\mu_{ij}$ represents the expected mean of the $i^{th}$
    observation in the $j^{th}$ Site
  - $\phi$ represents the dispersion parameter of the gamma
    distribution, controlling the shape of the distribution
  - $\beta_0$, $\beta_1$, $\beta_2$ and $\beta_3$ are the polynomial
    regression terms
  - $\gamma[Site_j\$ is the random intercept for the $j^th$ Site

- Model 3: mixed effect model with linear effects and first order auto-regressive structure 
  $$
  \begin{align}
  y_{ij} &\sim{} \Gamma(\mu_{ij}, \phi)\\
  log(\mu_{ij}) &= \beta_0 + \beta_1 x_{ij} + \gamma[Site_j] + \theta(y_{ij-1} - \mu_{ij-1})
  \end{align}
  $$
  
  where:
  
  - $y_{ij}$ is the $i^{th}$ observation in the $j^{th}$ Site
  - $\mu_{ij}$ represents the expected mean of the $i^{th}$
    observation in the $j^{th}$ Site
  - $\phi$ represents the dispersion parameter of the gamma
    distribution, controlling the shape of the distribution
  - $\beta_0$ and $\beta_1$ are the linear regression terms
  - $\gamma[Site_j\$ is the random intercept for the $j^th$ Site
  - $\theta(y_{ij-1} - \mu_{ij-1})$ is the stationary first order
    autoregressive structure, indicating the effect of the lagged
    dependent variable on the current mean within the $j^{th}$ Site.
    It has a covariance of $\sigma^2 exp(-\theta|s-t|)$ where $s$ and
    $t$ represent $y_i$ and $y_i-1$ respectively.

- Model 4: mixed effect model with linear effects
  $$
  \begin{align}
  y_{ij} &\sim{} \Gamma(\mu_{ij}, \phi)\\
  log(\mu_{ij}) &= \beta_0 + \beta_1 x_{ij} + \gamma[Site_j]
  \end{align}
  $$
  
  where:
  
  - $y_{ij}$ is the $i^{th}$ observation in the $j^{th}$ Site
  - $\mu_{ij}$ represents the expected mean of the $i^{th}$
    observation in the $j^{th}$ Site
  - $\phi$ represents the dispersion parameter of the gamma
    distribution, controlling the shape of the distribution
  - $\beta_0$ and $\beta_1$ are the linear regression terms
  - $\gamma[Site_j\$ is the random intercept for the $j^th$ Site

- Model 5: additive mixed effect model
  $$
  \begin{align}
  y_{ij} &\sim{} \Gamma(\mu_{ij}, \phi)\\
  log(\mu_{ij}) &= \beta_0 + f(x_{ij}) + \beta_1 Year_{ij} + \gamma[Site_j]
  \end{align}
  $$
  
  where:
  
  - $y_{ij}$ is the $i^{th}$ observation in the $j^{th}$ Site
  - $\mu_{ij}$ represents the expected mean of the $i^{th}$
    observation in the $j^{th}$ Site
  - $\phi$ represents the dispersion parameter of the gamma
    distribution, controlling the shape of the distribution
  - $\beta_0$ is the intercept
  - $f(x_{ij})$ represents a penalised spline smoother function over
    the $i^{th}$ covariate observation in the $j^{th}$ Site
  - $\beta_1 Year_{ij}$ represents the linear effect of the $i^{th}$
    Year in the $j^{th}$ Site
  - $\gamma[Site_j\$ is the random intercept for the $j^th$ Site
  
- Model 6: additive effect model
  $$
  \begin{align}
  y_{ij} &\sim{} \Gamma(\mu_{ij}, \phi)\\
  log(\mu_{ij}) &= \beta_0 + f(x_{ij})
  \end{align}
  $$
  
  where:
  
  - $y_{ij}$ is the $i^{th}$ observation in the $j^{th}$ Site
  - $\mu_{ij}$ represents the expected mean of the $i^{th}$
    observation in the $j^{th}$ Site
  - $\phi$ represents the dispersion parameter of the gamma
    distribution, controlling the shape of the distribution
  - $\beta_0$ is the intercept
  - $f(x_{ij})$ represents a penalised spline smoother function over
    the $i^{th}$ covariate observation in the $j^{th}$ Site
  
- Model 8: linear effect model
  $$
  \begin{align}
  y_{ij} &\sim{} \Gamma(\mu_{ij}, \phi)\\
  log(\mu_{ij}) &= \beta_0 + beta_1 x_{ij}
  \end{align}
  $$
  
  where:
  
  - $y_{ij}$ is the $i^{th}$ observation in the $j^{th}$ Site
  - $\mu_{ij}$ represents the expected mean of the $i^{th}$
    observation in the $j^{th}$ Site
  - $\phi$ represents the dispersion parameter of the gamma
    distribution, controlling the shape of the distribution
  - $\beta_0$ is the intercept
  - $\beta_1 x_{ij}$ represents the linear effect over the $i^{th}$
    covariate observation in the $j^{th}$ Site

The above models were fit for both routine and discrete sampling
designs separately.  Finally, the models were also run for three
different lag versions (lag 0: not lagged, lag 1: lag of one year, lag
2: lag of two years) of each pressure.  These lags allow us to explore
delayed effects of the drivers of the various pressures.  All GLMM's
and GAMMs were fit using the _glmmTMB_ (@RJ-2017-066) and _mgcv_
(@Wood-2003) R packages respectively within the R 4.2.2 Graphical and
Statistical Environment (@R-2023).

### Gradient Boosted Models

Gradient boosted models are a type of machine learning model that
combine a ensemble of weak learners (typically recursive partitioning
regression trees) to create a more accurate and powerful predictive
model. A key component of this technique is boosting, which involves
sequentially adding new models (trees) to incrementally learn the
patterns in the training data.

Briefly, gradient boosted models involve the following steps:

- initialization: Initially, the model starts with a simple regression tree.
- iterative training: the model is then trained iteratively to improve
  its performance. In each iteration, a new weak learner, is added to
  the model. This new learner is trained to focus on the data patterns
  that were poorly predicted by the previous models.
- gradient descent: during each iteration, the new weak learner is
  trained to minimize the errors or residuals made by the previous
  models. This is achieved using a technique called gradient
  descent. The new model is trained to fit the negative gradient of
  the loss function, with respect to the predictions made by the
  previous models.
- ensemble prediction: the predictions of all the weak learners are
  combined to make the final prediction. Each weak learner's
  prediction is weighted based on its performance, and the final
  prediction is the sum of these weighted predictions.
- regularization: to prevent over-fitting, regularization techniques
  such as shrinkage/learning rate and tree depth are
  applied. Shrinkage reduces the contribution of each new model,
  making the learning process slower and more conservative, while tree
  depth limits the complexity of individual trees.

Gradient boosted models have gained popularity due to their ability to
handle complex and non-linear relationships in the data, handle a
variety of data types, and provide accurate predictions. They are
widely used in various domains, including regression, classification,
and ranking tasks. 

Regular gradient boosted models do not offer any uncertainty
estimates.  In order to get estimates of uncertainty, it is necessary
to bootstrap the model.  Bootstrapping involves repeatedly fitting of a
model to randomly resampled (with replacement) data. 

For the current project, 100 bootstrapped gradient boosted models were
fit for each of the five stressors (ammonia, chlorophyll-a, dissolved
oxygen, filterable reactive phosphorus and turbidity) for each of the
routine and discrete sampling designs.  Each model contained the full
set of pressures.  As with the GLMMs/GAMMs lagged versions of the
models were also explore.  However, unlike the GLMM/GAMM models (which
only ever included a single lag, in the gradient boosted models, each
of the lagged versions of the pressures were added to the models.
Hence, both non-lagged and fully lagged versions of each model were fit.

More specifically, each gradient boosted model comprised 10,000 trees,
with a tree depth of 9, a bagging fraction of 0.5, a learning rate of
0.001 and 3 cross validation folds.  Once fitted, each tree was pruned
down via cross validation to prevent over-fitting.  The relative
influences of each pressure was estimated as the relative number of
tree splits involving that pressure.  For the purpose of graphical and
tabular summaries, only pressures whose relative influence exceeded
$100/p$ (where $p$ is the number of pressures) were retained.

Pseudo R² values associated with each individual pressure in a model
were determined according to the following equation: 

$$ 
R^2 = 1 - \frac{var(Pred - Obs)}{var(Obs)}
$$ 

where $Pred$ represents the partial predictions (predictions from the
model when all other pressures are held constant) and $Obs$ represent
the observed stressor values.

All gradient boosted models were performed using the _gbm_ (@GBM-2022)
package within the R 4.2.2 Statistical and Graphical Environment
(@R-2023).

# Summary of results

With such a large number of model combinations (routine/discrete,
lagged/non-lagged, five stressors, 33 pressures) as well as two
approaches (GLMM/GAMM and GBM), it was challenging to distil all the
results down into a small number of figures/tables that were able to
highlight the main patterns.

The following selections summarise all the findings in a series of
cross summation tables broken down into spatial scales (whole harbour
then each zone) for both routine and discrete sampling designs.  In
each table, the five focal stressors appear in the columns and the top
influential pressures across these stressors form the rows.  The
influence of pressures was determined based on the percentage of total
GBM splits featuring those pressures.

Each cell was divided into the pseudo R² from the GBM (upper left of
cells) and GLMM/GAMM (lower right of cells).  Further, cell triangles
are shaded according to the magnitude (depth of colour) and polarity
(red: negative, green: positive) of the correlation attributed to the
focal pressure.  Pressures were ordered in the tables according to the
sum of pseudo R² values across all stressors for both GLMM/GAMM and
GBM.

Collectively, the two halves of each cell provide two lines of
evidence and perspectives on the predictive influence of a stressor on
a pressure.  For example, if both halves have relatively high pseudo
R² values (and are similarity coloured), we can conclude that there is
reasonably strong evidence that changes in the focal stressor are in
some way associated with the focal pressure.  On the other hand, if
only one half of the triangle is coloured, it might indicate that
support for this association is less.

If there were numerous pressures for a particular stressor that each
have a similar pseudo R² and colour in the lower right side of a cell,
yet this was not the case for the upper right side of the cell, it
suggested that these pressures were all correlated to one another.  In
such cases, it was likely that only one of the pressures was genuinely
correlated with the stressor.  The pseudo R² values for the GBM were
expected to be lower than their GLMM/GAMM counterparts since the
influences of each stressor was potentially diluted in the former by
the presence of the large number of additional (sometimes competing)
stressors.

The following sections illustrate the associations in non-lagged
pressures.  Summaries for analyses involving lagged pressures are
presented in Appendix F.  Overall, the associations between stressors
and lagged pressures are weaker, more complex and more difficult to
distil.

## Whole harbour

Across the whole harbour for routine samples, there was (see Figure
\@ref(fig:summary-routine-WH-nolags)):

- evidence of weak positive associations between Total P load and
  Chlorophyll-a, Filterable reactive phosphate, NOx and Turbidity
- some evidence of weak positive associations between Total suspended
  solids loads and Chlorophyll-a and Filterable reactive phosphate
- some evidence of weak positive associations between Volatile
  suspended solid loads and Chlorophyll-a, Filterable reactive phosphate
  and Turbidity
- some evidence of weak positive associations between Estimated
  resident population and all of the stressors (except perhaps
  Ammonia)

Similar patterns (albeit typically a little less pronounced) were also
apparent for the discrete samples (Figure
\@ref(fig:summary-discrete-WH-nolags)).  These patterns are likely the
result of large spatial scale associations.  For example, if the sites
in one zone are substantially higher in both Chlorophyll-a and Total P
loads than the sites of other zones, then a positive association at
the whole harbour scale will result.

<!---BLOCK_LANDSCAPE_START--->

## Routine samples (no lags

```{r summary-routine-WH-nolags}
#| results: 'markdown'
#| eval: TRUE
#| fig.show: 'hold'
#| fig.align: 'center'
#| fig.width: 8.5
#| fig.height: 4.533
#| fig.cap: "Cross summarisation of pseudo-R² values from boosted regression trees (upper left of table cells) and generalized (additive) models (lower right of table cells) associated with each combination of stressors (columns) and pressures (rows) for the whole of the Darwin Harbour **routine samples**.  Cells are also coloured according to the degree of correlation (R - derived from R² and polarity of trends).  The darker the cell shading, the larger in magnitude the R².  Green and orange/red shading signify positive and negative trends respectively. "

include_graphics("../output/figures/summary_table__Routine_Whole Harbour__noLags.png", dpi = 300)
```

### Discrete samples (no lags)

```{r summary-discrete-WH-nolags}
#| results: 'markdown'
#| eval: TRUE
#| fig.show: 'hold'
#| fig.align: 'center'
#| fig.width: 8.5
#| fig.height: 4.533
#| fig.cap: "Cross summarisation of pseudo-R² values from boosted regression trees (upper left of table cells) and generalized (additive) models (lower right of table cells) associated with each combination of stressors (columns) and pressures (rows) for the whole of the Darwin Harbour discrete samples.  Cells are also coloured according to the degree of correlation (R - derived from R² and polarity of trends).  The darker the cell shading, the larger in magnitude the R².  Green and orange/red shading signify positive and negative trends respectively. "

include_graphics("../output/figures/summary_table__Discrete_Whole Harbour__noLags.png", dpi = 300)
```

<!---BLOCK_LANDSCAPE_STOP--->

## Zones

The patterns within the zones are more refined and are due to either
smaller spatial scale patterns (differences between sites within the
zones) or else temporal fluctuations (both variables changing over
time). Rather than provide a list of important associations per zone
for each of routine and discrete samples, attempts have been made to
synthesise the major associations across all the zones.  Given that
such syntheses will be in three dimensions (zone, stressor and
pressure), there are at least three ways to present the syntheses:

- list the important associations separately for each zone
- list the important associations separately for each stressor
- list the important associations separately for each pressure

Whilst inevitably repetitious, the presentation of each of these
alternatives provides different foci.  For example, presenting the
associations separately for each zone, allows us to quickly identify
which and how many potential drivers operate within particular zones.
By contrast, observing the associations from the perspective of the
individual stressors, allows us to identify which pressures potential
drive each stressor and how spatially widespread the associations are.
Consequently, each of the alternative presentations will be presented.

*Associations per zone*

The following list provides a summary of the main pressures identified
within each zone along with the stressor(s) they are associated with
and the polarity of the associations (+ = positive, - = negative).
NH3 denotes ammonia, Chl denotes chlorophyll-a, DO denotes dissolved
oxygen, PO4 denotes filterable reactive phosphate, NOx denotes NOx as
N and Turb denotes turbidity.

- there are no major associations between pressures and stressors
  observable within Buffalo Creek (Figures
  \@ref(fig:summary-routine-Buffalo-nolags)-\@ref(fig:summary-discrete-Buffalo-nolags))
- East Arm (Figures \@ref(fig:summary-routine-EastArm-nolags)-\@ref(fig:summary-discrete-EastArm-nolags)):
  - Rainfall anomaly (Chl:+, Turbidity:-)
  - SST anomaly (PO4:-)
  - Total P load (DO:-, Turbidity:+)
- Central Harbour (Figures \@ref(fig:summary-routine-CentralHarbour-nolags)-\@ref(fig:summary-discrete-CentralHarbour-nolags)):
  - Gross regional product (PO4:-, Chl:+)
  - Gross regional product change (Chl:-, Turbidity:-)
  - SST anomaly (Chl:-, PO4:-, Turbidity:-)
  - Live shipping: (Chl:+)
  - Total building expenditure: (DO:+)
- Elizabeth River (Figures \@ref(fig:summary-routine-ElizabethRiver-nolags)-\@ref(fig:summary-discrete-ElizabethRiver-nolags)):
  - Rainfall anomaly (Turb:-)
  - Liquid shipping: (Chl:-, DO:-)
  - Carrier shipping: (PO4:-)
  - Cruise Ship: (Chl:+)
- Outer Harbour (Figures \@ref(fig:summary-routine-OuterHarbour-nolags)-\@ref(fig:summary-discrete-OuterHarbour-nolags)):
  - SST anomaly: (PO4:-)
- Middle Arm (Figures \@ref(fig:summary-routine-MiddleArm-nolags)-\@ref(fig:summary-discrete-MiddleArm-nolags)):
  - Fire frequency: (DO:+, Turbidity:-)
- West Arm (Figures \@ref(fig:summary-routine-WestArm-nolags)-\@ref(fig:summary-discrete-WestArm-nolags)):
  - Rainfall anomaly (Chl:+)
  - SST anomaly (Chl:+)
  - Liquid shipping (Chl:+)
- Shoal Bay (Figures \@ref(fig:summary-routine-ShoalBay-nolags)):
  - Rainfall anomaly (DO:-)
  - Mean air temperature (DO:-)

*Associations per stressor*

In the following nested list, 
B denotes Buffalo Creek,
CH denotes Central Harbour,
EA denotes East Arm, 
ER denotes Elizabeth River, 
MA denotes Middle Arm, 
OH denotes Outer Harbour, 
SB denotes Shoal Bay and 
WA denotes West Arm.  Polarity symbols follow the same scheme as outlined above.

- Ammonia: - no obvious associations
- Chlorophyll-a:
  - Rainfall anomaly (EA:+, WA:+)
  - SST anomaly (CH:-, WA:-) 
  - Gross regional product (CH:-)
  - Estimated resident population growth (CH:-)
  - Estimated resident population (CH:+, WA:+)
  - Live shipping (CH:+)
  - Liquid shipping (ER:-)
- Dissolved Oxygen:
  - Total P load (EA:-)
  - Air temperature anomaly (EA:-)
  - Total N load (EA:-)
  - Total building (CH:+)
  - Liquid shipping (ER:-)
  - Air temperature anomaly (OH:-)
  - Fire frequency (MA:+)
  - Cruise shipping (MA:+)
  - Air temperature anomaly (SB:-)
  - Rainfall anomaly (SB:-)
  - Total Building (SB:+)
- Filterable Reactive Phosphate:
  - Gross regional product (EA:-, CH:-, MH:-, WA:-)
  - SST anomaly (EA:+, CH:-, OH:-)
  - Carrier shipping (ER:-)
  - Air temperature anomaly (OH:-) 
- NOx as N:
  - Gross regional product (WA:-)
- Turbidity:
  - Total P load (EA:+)
  - Gross regional product (CH:+)
  - Carrier shipping (ER:-)
  - Rainfall anomaly (ER:-, OH:-)
  - Bulk shipping (MA:-)
  - Fire frequency (MA:-)

*Associations per pressure*

In the following nested list, 
B denotes Buffalo Creek,
CH denotes Central Harbour,
EA denotes East Arm, 
ER denotes Elizabeth River, 
MA denotes Middle Arm, 
OH denotes Outer Harbour, 
SB denotes Shoal Bay and 
WA denotes West Arm.  Polarity symbols follow the same scheme as above.

- Rainfall anomaly
  - Chlorophyll-a (EA:+, WA:+)
  - Turbidity (ER:-, OH:-)
  - Dissolved oxygen (SB:-)
- Gross regional product:
  - Filterable reactive phosphate (CH:-)
  - Chlorophyll-a (CH:-)
  - Turbidity (CH:-)
- SST anomaly:
  - Chlorophyll-a (CH:-, WA:-)
  - Filterable reactive phosphate (EA:-, CH:-, OH:-)
- Total P load: 
  - Dissolved oxygen (EA:-)
  - Turbidity (EA:+)
- Estimated resident population:
  - Chlorophyll-a (CH:+)
- Live shipping:
  - Chlorophyll-a (CH:+)
- Liquid shipping:
  - Chlorophyll-a (ER:-, WA:-) 
  - Dissolved oxygen (ER:-) 
- Carrier shipping: 
  - Filterable reactive phosphate (ER:-)
- Cruise shipping:
  - Chlorophyll-a (ER:+)
- Total building expenditure: 
  - Dissolved oxygen (CH:+, SH:+)
- Fire frequency:
  - Dissolved oxygen (MA:+) 
  - Turbidity (MA:-)
- Mean air temperature: 
  - Dissolved oxygen (SB:+)
 
Summaries for analyses involving lagged pressures are presented in
Appendix F.

<!---BLOCK_LANDSCAPE_START--->

### Buffalo Creek (routine samples, no lags)

```{r summary-routine-Buffalo-nolags}
#| results: 'markdown'
#| eval: TRUE
#| fig.show: 'hold'
#| fig.align: 'center'
#| fig.width: 8.5
#| fig.height: 4.533
#| fig.cap: "Cross summarisation of pseudo-R² values from boosted regression trees (upper left of table cells) and generalized (additive) models (lower right of table cells) associated with each combination of stressors (columns) and pressures (rows) for the Buffalo Creek **routine samples**.  Cells are also coloured according to the degree of correlation (R - derived from R² and polarity of trends).  The darker the cell shading, the larger in magnitude the R².  Green and orange/red shading signify positive and negative trends respectively. "

include_graphics("../output/figures/summary_table__Routine_Buffalo Creek__noLags.png", dpi = 300)
```

### Buffalo Creek (discrete samples, no lags)

```{r summary-discrete-Buffalo-nolags}
#| results: 'markdown'
#| eval: TRUE
#| fig.show: 'hold'
#| fig.align: 'center'
#| fig.width: 8.5
#| fig.height: 4.533
#| fig.cap: "Cross summarisation of pseudo-R² values from boosted regression trees (upper left of table cells) and generalized (additive) models (lower right of table cells) associated with each combination of stressors (columns) and pressures (rows) for the Buffalo Creek discrete samples.  Cells are also coloured according to the degree of correlation (R - derived from R² and polarity of trends).  The darker the cell shading, the larger in magnitude the R².  Green and orange/red shading signify positive and negative trends respectively. "

include_graphics("../output/figures/summary_table__Discrete_Buffalo Creek__noLags.png", dpi = 300)
```

### East Arm (routine samples, no lags)

```{r summary-routine-EastArm-nolags}
#| results: 'markdown'
#| eval: TRUE
#| fig.show: 'hold'
#| fig.align: 'center'
#| fig.width: 8.5
#| fig.height: 4.533
#| fig.cap: "Cross summarisation of pseudo-R² values from boosted regression trees (upper left of table cells) and generalized (additive) models (lower right of table cells) associated with each combination of stressors (columns) and pressures (rows) for the East Arm **routine samples**.  Cells are also coloured according to the degree of correlation (R - derived from R² and polarity of trends).  The darker the cell shading, the larger in magnitude the R².  Green and orange/red shading signify positive and negative trends respectively. "

include_graphics("../output/figures/summary_table__Routine_East Arm__noLags.png", dpi = 300)
```

### East Arm (discrete samples, no lags)

```{r summary-discrete-EastArm-nolags}
#| results: 'markdown'
#| eval: TRUE
#| fig.show: 'hold'
#| fig.align: 'center'
#| fig.width: 8.5
#| fig.height: 4.533
#| fig.cap: "Cross summarisation of pseudo-R² values from boosted regression trees (upper left of table cells) and generalized (additive) models (lower right of table cells) associated with each combination of stressors (columns) and pressures (rows) for the East Arm discrete samples.  Cells are also coloured according to the degree of correlation (R - derived from R² and polarity of trends).  The darker the cell shading, the larger in magnitude the R².  Green and orange/red shading signify positive and negative trends respectively. "

include_graphics("../output/figures/summary_table__Discrete_East Arm__noLags.png", dpi = 300)
```

### Central Harbour (routine samples, no lags)

```{r summary-routine-CentralHarbour-nolags}
#| results: 'markdown'
#| eval: TRUE
#| fig.show: 'hold'
#| fig.align: 'center'
#| fig.width: 8.5
#| fig.height: 4.533
#| fig.cap: "Cross summarisation of pseudo-R² values from boosted regression trees (upper left of table cells) and generalized (additive) models (lower right of table cells) associated with each combination of stressors (columns) and pressures (rows) for the Central Harbour routine samples.  Cells are also coloured according to the degree of correlation (R - derived from R² and polarity of trends).  The darker the cell shading, the larger in magnitude the R².  Green and orange/red shading signify positive and negative trends respectively. "

include_graphics("../output/figures/summary_table__Routine_Central Harbour__noLags.png", dpi = 300)
```

### Central Harbour (discrete samples, no lags)

```{r summary-discrete-CentralHarbour-nolags}
#| results: 'markdown'
#| eval: TRUE
#| fig.show: 'hold'
#| fig.align: 'center'
#| fig.width: 8.5
#| fig.height: 4.533
#| fig.cap: "Cross summarisation of pseudo-R² values from boosted regression trees (upper left of table cells) and generalized (additive) models (lower right of table cells) associated with each combination of stressors (columns) and pressures (rows) for the Central Harbour discrete samples.  Cells are also coloured according to the degree of correlation (R - derived from R² and polarity of trends).  The darker the cell shading, the larger in magnitude the R².  Green and orange/red shading signify positive and negative trends respectively. "

include_graphics("../output/figures/summary_table__Discrete_Central Harbour__noLags.png", dpi = 300)
```

### Elizabeth River (routine samples, no lags)

```{r summary-routine-ElizabethRiver-nolags}
#| results: 'markdown'
#| eval: TRUE
#| fig.show: 'hold'
#| fig.align: 'center'
#| fig.width: 8.5
#| fig.height: 4.533
#| fig.cap: "Cross summarisation of pseudo-R² values from boosted regression trees (upper left of table cells) and generalized (additive) models (lower right of table cells) associated with each combination of stressors (columns) and pressures (rows) for the Elizabeth River routine samples.  Cells are also coloured according to the degree of correlation (R - derived from R² and polarity of trends).  The darker the cell shading, the larger in magnitude the R².  Green and orange/red shading signify positive and negative trends respectively. "

include_graphics("../output/figures/summary_table__Routine_Elizabeth River__noLags.png", dpi = 300)
```

### Elizabeth River (discrete samples, no lags)

```{r summary-discrete-ElizabethRiver-nolags}
#| results: 'markdown'
#| eval: TRUE
#| fig.show: 'hold'
#| fig.align: 'center'
#| fig.width: 8.5
#| fig.height: 4.533
#| fig.cap: "Cross summarisation of pseudo-R² values from boosted regression trees (upper left of table cells) and generalized (additive) models (lower right of table cells) associated with each combination of stressors (columns) and pressures (rows) for the Elizabeth River discrete samples.  Cells are also coloured according to the degree of correlation (R - derived from R² and polarity of trends).  The darker the cell shading, the larger in magnitude the R².  Green and orange/red shading signify positive and negative trends respectively. "

include_graphics("../output/figures/summary_table__Discrete_Elizabeth River__noLags.png", dpi = 300)
```

### Outer Harbour (routine samples, no lags)

```{r summary-routine-OuterHarbour-nolags}
#| results: 'markdown'
#| eval: TRUE
#| fig.show: 'hold'
#| fig.align: 'center'
#| fig.width: 8.5
#| fig.height: 4.533
#| fig.cap: "Cross summarisation of pseudo-R² values from boosted regression trees (upper left of table cells) and generalized (additive) models (lower right of table cells) associated with each combination of stressors (columns) and pressures (rows) for the Outer Harbour routine samples.  Cells are also coloured according to the degree of correlation (R - derived from R² and polarity of trends).  The darker the cell shading, the larger in magnitude the R².  Green and orange/red shading signify positive and negative trends respectively. "

include_graphics("../output/figures/summary_table__Routine_Outer Harbour__noLags.png", dpi = 300)
```

### Outer Harbour (discrete samples, no lags)

```{r summary-discrete-OuterHarbour-nolags}
#| results: 'markdown'
#| eval: TRUE
#| fig.show: 'hold'
#| fig.align: 'center'
#| fig.width: 8.5
#| fig.height: 4.533
#| fig.cap: "Cross summarisation of pseudo-R² values from boosted regression trees (upper left of table cells) and generalized (additive) models (lower right of table cells) associated with each combination of stressors (columns) and pressures (rows) for the Outer Harbour discrete samples.  Cells are also coloured according to the degree of correlation (R - derived from R² and polarity of trends).  The darker the cell shading, the larger in magnitude the R².  Green and orange/red shading signify positive and negative trends respectively. "

include_graphics("../output/figures/summary_table__Discrete_Outer Harbour__noLags.png", dpi = 300)
```

### Middle Arm (routine samples, no lags)

```{r summary-routine-MiddleArm-nolags}
#| results: 'markdown'
#| eval: TRUE
#| fig.show: 'hold'
#| fig.align: 'center'
#| fig.width: 8.5
#| fig.height: 4.533
#| fig.cap: "Cross summarisation of pseudo-R² values from boosted regression trees (upper left of table cells) and generalized (additive) models (lower right of table cells) associated with each combination of stressors (columns) and pressures (rows) for the Middle Arm routine samples.  Cells are also coloured according to the degree of correlation (R - derived from R² and polarity of trends).  The darker the cell shading, the larger in magnitude the R².  Green and orange/red shading signify positive and negative trends respectively. "

include_graphics("../output/figures/summary_table__Routine_Middle Arm__noLags.png", dpi = 300)
```

### Middle Arm (discrete samples, no lags)

```{r summary-discrete-MiddleArm-nolags}
#| results: 'markdown'
#| eval: TRUE
#| fig.show: 'hold'
#| fig.align: 'center'
#| fig.width: 8.5
#| fig.height: 4.533
#| fig.cap: "Cross summarisation of pseudo-R² values from boosted regression trees (upper left of table cells) and generalized (additive) models (lower right of table cells) associated with each combination of stressors (columns) and pressures (rows) for the Middle Arm discrete samples.  Cells are also coloured according to the degree of correlation (R - derived from R² and polarity of trends).  The darker the cell shading, the larger in magnitude the R².  Green and orange/red shading signify positive and negative trends respectively. "

include_graphics("../output/figures/summary_table__Discrete_Middle Arm__noLags.png", dpi = 300)
```

### West Arm (routine samples, no lags)

```{r summary-routine-WestArm-nolags}
#| results: 'markdown'
#| eval: TRUE
#| fig.show: 'hold'
#| fig.align: 'center'
#| fig.width: 8.5
#| fig.height: 4.533
#| fig.cap: "Cross summarisation of pseudo-R² values from boosted regression trees (upper left of table cells) and generalized (additive) models (lower right of table cells) associated with each combination of stressors (columns) and pressures (rows) for the West Arm routine samples.  Cells are also coloured according to the degree of correlation (R - derived from R² and polarity of trends).  The darker the cell shading, the larger in magnitude the R².  Green and orange/red shading signify positive and negative trends respectively. "

include_graphics("../output/figures/summary_table__Routine_West Arm__noLags.png", dpi = 300)
```

### West Arm (discrete samples, no lags)

```{r summary-discrete-WestArm-nolags}
#| results: 'markdown'
#| eval: TRUE
#| fig.show: 'hold'
#| fig.align: 'center'
#| fig.width: 8.5
#| fig.height: 4.533
#| fig.cap: "Cross summarisation of pseudo-R² values from boosted regression trees (upper left of table cells) and generalized (additive) models (lower right of table cells) associated with each combination of stressors (columns) and pressures (rows) for the West Arm discrete samples.  Cells are also coloured according to the degree of correlation (R - derived from R² and polarity of trends).  The darker the cell shading, the larger in magnitude the R².  Green and orange/red shading signify positive and negative trends respectively. "

include_graphics("../output/figures/summary_table__Discrete_West Arm__noLags.png", dpi = 300)
```

### Shoal Bay (routine samples, no lags)

```{r summary-routine-ShoalBay-nolags}
#| results: 'markdown'
#| eval: TRUE
#| fig.show: 'hold'
#| fig.align: 'center'
#| fig.width: 8.5
#| fig.height: 4.533
#| fig.cap: "Cross summarisation of pseudo-R² values from boosted regression trees (upper left of table cells) and generalized (additive) models (lower right of table cells) associated with each combination of stressors (columns) and pressures (rows) for the Shoal Bay routine samples.  Cells are also coloured according to the degree of correlation (R - derived from R² and polarity of trends).  The darker the cell shading, the larger in magnitude the R².  Green and orange/red shading signify positive and negative trends respectively. "

include_graphics("../output/figures/summary_table__Routine_Shoal Bay__noLags.png", dpi = 300)
```

<!---BLOCK_LANDSCAPE_STOP--->

# Conclusions

The present study has revealed numerous statistical associations
between water quality stressors and pressures/drivers.  At the scale
of the whole harbour, higher levels of chlorophyll-a, filterable total
phosphate, NOx and turbidity are associated with higher levels of
total P load, total and volatile suspended solids as well as estimated
resident population.  Further work would need to be conducted in order
to ascertain whether any of these associations have any causal
mechanisms or whether they reflect that at this broad scale both the
stressors and aforementioned pressures are incidentally correlated as a
result of being governed by similar sets of unmeasured conditions and
drivers.

Unlike the whole of harbour analyses, which are likely driven by large
spatial scale differences in levels of both the pressures and
stressors, the zone analyses are likely to be driven exclusively by
temporal changes in both the pressures and stressors.  The study did
reveal some broad similarities between the potentially correlated
pressures across the different zones of Darwin Harbour.  For example,
correlations featuring rainfall or SST anomaly and some form of
shipping activity).  Nevertheless, the absence of a consistent set of
influential pressures/drivers as well as which stressors they
potentially influence suggests that, if present, the underlying
associations are substantially more complex and nuanced than can be
detected from the data available.  Each zone comprised a number of
sampling locations, each of which may have varied substantially in
exposure to the pressures (since the pressures are not measured at the
level of the locations, but rather the sub-catchment).  With
additional data and resources, it may be possible in the future to
identify which locations are have the highest exposure to the
different pressures and drivers and thereby gain greater insights into
the mechanisms underlying any causal links.

It is important to acknowledge that it is also possible that the
correlations highlighted in this study may be purely coincidental or
indeed statistical artefacts.

# Acknowledgements

This report was funded by the INPEX-operated Ichthys LNG Project.

# References

<div id="refs"></div>
 
\newpage

<!-- data set summaries-->
```{r appendixA, child = "../docs/Appendix.rmd", cache = TRUE, eval = TRUE}
```
    
\newpage
<!-- stressor trends-->
```{r appendixB, child = "../docs/AppendixB.rmd", cache = TRUE, eval = TRUE}
```

\newpage
<!-- pressure trends-->
```{r appendixC, child = "../docs/AppendixC.rmd", cache = TRUE, eval = TRUE}
```
 
\newpage
<!-- stressor EDA-->
```{r appendixD, child = "../docs/AppendixD.rmd", cache = TRUE, eval = TRUE}
```
 
\newpage
<!-- pressure EDA-->
```{r appendixE, child = "../docs/AppendixE.rmd", cache = TRUE, eval = TRUE}
```
 
\newpage
<!-- lagged association tables-->
```{r appendixF, child = "../docs/AppendixF.rmd", cache = TRUE, eval = TRUE}
```
